(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{367:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var r="";r=window.location.origin+"/api"},375:function(e,t,a){var r=a(397);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,a(18).default)("fed9e4ce",r,!0,{})},396:function(e,t,a){"use strict";var r=a(375);a.n(r).a},397:function(e,t,a){(e.exports=a(17)(!1)).push([e.i,"\n.el-table[data-v-46da4130] {\n  margin-top: 15px;\n}\n.el-form-item[data-v-46da4130] {\n  margin-bottom: 15px;\n}\n.el-pagination[data-v-46da4130] {\n  margin-top: 15px;\n}\n",""])},417:function(e,t,a){"use strict";a.r(t);var o=a(367),r={data:function(){var r=this;return{newUserDialog:!1,dialogStatus:"add",newUserForm:{role:""},tableData:[],loading:!1,tablePageSize:10,pagination:{},newUserFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],oldPassword:[{required:!0,message:"请输入原密码",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],passwordAgain:[{required:!0,validator:function(e,t,a){t?t!==r.newUserForm.password?a(new Error("两次输入的密码不同")):a():a(new Error("请重复输入密码"))},trigger:"blur"}]}}},created:function(){this.getUserList()},methods:{resetForm:function(){this.$refs.userForm.resetFields(),this.newUserForm={role:""},this.dialogStatus="add"},confirmBtn:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;"add"===t.dialogStatus?t.axios.post("".concat(o.a,"/register"),t.newUserForm).then(function(e){1===e.data?(t.$message.success("用户添加成功"),t.newUserDialog=!1,t.resetForm(),t.getUserList()):t.$message.error(e.data)}).catch(function(e){console.log(e)}).finally(function(){}):t.axios.patch("".concat(o.a,"/user"),t.newUserForm).then(function(e){1===e.data?(t.$message.success("用户信息修改成功"),t.newUserDialog=!1,t.resetForm(),t.getUserList()):t.$message.error(e.data)}).catch(function(e){console.log(e)}).finally(function(){})})},cancelBtn:function(){this.newUserDialog=!1,this.resetForm()},closeUserForm:function(){this.resetForm()},getUserList:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{page:1,pageSize:this.tablePageSize},a=e.page,r=void 0===a?1:a,s=e.pageSize,n=void 0===s?this.tablePageSize:s;this.loading=!0,this.axios.get("".concat(o.a,"/user"),{params:{page:r,pageSize:n}}).then(function(e){t.tableData=e.data.data,t.pagination=e.data.pagination}).catch(function(e){t.$message.error(e)}).finally(function(){t.loading=!1})},rowClick:function(){},handleSelectionChange:function(){},handleCurrentChange:function(e){this.getUserList({page:e,page_size:this.tablePageSize})},handleSizeChange:function(e){this.tablePageSize=e,this.getUserList({page:1,page_size:this.tablePageSize})},editUser:function(e){this.dialogStatus="edit",this.newUserDialog=!0,this.newUserForm.name=e.name,this.newUserForm.username=e.username,this.newUserForm.role=e.role,this.newUserForm.email=e.email,this.newUserForm.id=e._id},deleteUser:function(e,t){var a=this;this.$confirm("确定要删除用户 ".concat(t," 吗?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.axios.delete("".concat(o.a,"/user/").concat(e)).then(function(e){a.$message.success("用户删除成功"),a.getUserList()})}).catch(function(){a.$message({type:"info",message:"已取消操作"})})},refreshTable:function(){this.getUserList()}}},s=(a(396),a(54)),n=Object(s.a)(r,function(){var a=this,e=a.$createElement,r=a._self._c||e;return r("div",{staticClass:"page-container"},[r("div",[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){a.newUserDialog=!0}}},[a._v("新增用户")]),a._v(" "),r("el-button",{attrs:{size:"small"},on:{click:a.refreshTable}},[a._v("刷新列表")])],1),a._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],ref:"userTable",staticStyle:{width:"100%"},attrs:{data:a.tableData,"tooltip-effect":"dark"},on:{"row-click":a.rowClick,"selection-change":a.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),a._v(" "),r("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center",fixed:""}}),a._v(" "),r("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center",fixed:""}}),a._v(" "),r("el-table-column",{attrs:{prop:"role",label:"角色",align:"center"}}),a._v(" "),r("el-table-column",{attrs:{prop:"email",label:"邮箱",align:"center"}}),a._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center",fixed:"right"},scopedSlots:a._u([{key:"default",fn:function(t){return[r("div",{staticClass:"flex justify-content-center"},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){a.editUser(t.row)}}},[a._v(" 修改")]),a._v(" "),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){a.deleteUser(t.row._id,t.row.name)}}},[a._v(" 删除")])],1)]}}])})],1),a._v(" "),r("el-pagination",{staticClass:"flex justify-content-center ",attrs:{"page-sizes":[10,20,30,40],layout:"sizes, prev, pager, next",background:"","page-size":a.pagination.pageSize,"current-page":a.pagination.currentPage,total:a.pagination.total},on:{"size-change":a.handleSizeChange,"current-change":a.handleCurrentChange}}),a._v(" "),r("el-dialog",{attrs:{title:"add"===a.dialogStatus?"新增用户":"编辑用户",visible:a.newUserDialog,center:"",width:"400px"},on:{"update:visible":function(e){a.newUserDialog=e},close:a.closeUserForm}},[r("el-form",{ref:"userForm",attrs:{model:a.newUserForm,"label-width":"80px",rules:a.newUserFormRules}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{attrs:{size:"small",clearable:"",placeholder:"用于登录",disabled:"edit"===a.dialogStatus},model:{value:a.newUserForm.username,callback:function(e){a.$set(a.newUserForm,"username",e)},expression:"newUserForm.username"}})],1),a._v(" "),r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{attrs:{size:"small",clearable:"",placeholder:"姓名",disabled:"edit"===a.dialogStatus},model:{value:a.newUserForm.name,callback:function(e){a.$set(a.newUserForm,"name",e)},expression:"newUserForm.name"}})],1),a._v(" "),"edit"===a.dialogStatus?r("el-form-item",{attrs:{label:"原密码",prop:"oldPassword"}},[r("el-input",{attrs:{size:"small",clearable:"",type:"password",placeholder:"密码"},model:{value:a.newUserForm.oldPassword,callback:function(e){a.$set(a.newUserForm,"oldPassword",e)},expression:"newUserForm.oldPassword"}})],1):a._e(),a._v(" "),r("el-form-item",{attrs:{label:"add"===a.dialogStatus?"密码":"新密码",prop:"password"}},[r("el-input",{attrs:{size:"small",clearable:"",type:"password",placeholder:"密码"},model:{value:a.newUserForm.password,callback:function(e){a.$set(a.newUserForm,"password",e)},expression:"newUserForm.password"}})],1),a._v(" "),r("el-form-item",{attrs:{label:"重复密码",prop:"passwordAgain"}},[r("el-input",{attrs:{size:"small",clearable:"",type:"password",placeholder:"重复密码"},model:{value:a.newUserForm.passwordAgain,callback:function(e){a.$set(a.newUserForm,"passwordAgain",e)},expression:"newUserForm.passwordAgain"}})],1),a._v(" "),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{attrs:{size:"small",clearable:"",placeholder:"邮箱地址"},model:{value:a.newUserForm.email,callback:function(e){a.$set(a.newUserForm,"email",e)},expression:"newUserForm.email"}})],1),a._v(" "),r("el-form-item",{attrs:{label:"角色",prop:"role"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:"",tplaceholder:"角色"},model:{value:a.newUserForm.role,callback:function(e){a.$set(a.newUserForm,"role",e)},expression:"newUserForm.role"}},[r("el-option",{attrs:{label:"管理员",value:"管理员"}}),a._v(" "),r("el-option",{attrs:{label:"普通用户",value:"普通用户"}})],1)],1)],1),a._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){a.confirmBtn("userForm")}}},[a._v("确定")]),a._v(" "),r("el-button",{attrs:{size:"small"},on:{click:a.cancelBtn}},[a._v("取消")])],1)],1)],1)},[],!1,null,"46da4130",null);n.options.__file="user.vue";t.default=n.exports}}]);